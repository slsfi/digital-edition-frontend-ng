@let text = text$ | async;

@if (text === undefined) {
  <ion-spinner class="loading" name="crescent"></ion-spinner>
} @else {
  @let viewOptions = viewOptionsService.show();

  <div class="tei teiContainer"
        [class.show_comments]="viewOptions.comments"
        [class.show_personInfo]="viewOptions.personInfo"
        [class.show_workInfo]="viewOptions.workInfo"
        [class.show_abbreviations]="viewOptions.abbreviations"
  >

    <div [innerHTML]="text | trustHtml"></div>

    @let letterData = letter();

    @if (letterData) {
      <div class="ms">
        <h3 i18n="@@Commentary.Manuscript.Title">Manuskriptbeskrivning</h3>

        <ul>
          @if (letterData.legacy_id) {
            <li><ng-container i18n="@@Commentary.Manuscript.LegacyId">Brevsignum</ng-container>: {{ letterData.legacy_id }}</li>
          }
          @if (sender()) {
            <li><ng-container i18n="@@Commentary.Manuscript.Sender">Avsändare</ng-container>: {{ sender() }}</li>
          }
          @if (receiver()) {
            <li><ng-container i18n="@@Commentary.Manuscript.Receiver">Mottagare</ng-container>: {{ receiver() }}</li>
          }
          @if (letterData.source_archive) {
            <li><ng-container i18n="@@Commentary.Manuscript.Archive">Arkiv</ng-container>: {{ letterData.source_archive }}</li>
          }
          @if (letterData.source_collection_id) {
            <li><ng-container i18n="@@Commentary.Manuscript.Collection">Samling, signum</ng-container>: {{ letterData.source_collection_id }}</li>
          }
        </ul>

        <ul>
          @if (letterData.material_type) {
            <li><ng-container i18n="@@Commentary.Manuscript.Type">Form</ng-container>: {{ letterData.material_type }}</li>
          }
          @if (letterData.material_source) {
            <li><ng-container i18n="@@Commentary.Manuscript.Status">Status</ng-container>: {{ letterData.material_source }}</li>
          }
          @if (letterData.material_format) {
            <li><ng-container i18n="@@Commentary.Manuscript.Format">Format</ng-container>: {{ letterData.material_format }}</li>
          }
          @if (letterData.leaf_count) {
            <li><ng-container i18n="@@Commentary.Manuscript.Leafs">Lägg</ng-container>: {{ letterData.leaf_count }}</li>
          }
          @if (letterData.sheet_count) {
            <li><ng-container i18n="@@Commentary.Manuscript.Sheets">Antal blad</ng-container>: {{ letterData.sheet_count }}</li>
          }
          @if (letterData.page_count) {
            <li><ng-container i18n="@@Commentary.Manuscript.Pages">Sidor brevtext</ng-container>: {{ letterData.page_count }}</li>
          }
          @if (letterData.material_color) {
            <li><ng-container i18n="@@Commentary.Manuscript.Color">Färg</ng-container>: {{ letterData.material_color }}</li>
          }
          @if (letterData.material_quality) {
            <li><ng-container i18n="@@Commentary.Manuscript.Quality">Kvalitet</ng-container>: {{ letterData.material_quality }}</li>
          }
          @if (letterData.material_pattern) {
            <li><ng-container i18n="@@Commentary.Manuscript.Pattern">Mönster</ng-container>: {{ letterData.material_pattern }}</li>
          }
          @if (letterData.material_state) {
            <li><ng-container i18n="@@Commentary.Manuscript.State">Tillstånd</ng-container>: {{ letterData.material_state }}</li>
          }
          @if (letterData.material) {
            <li><ng-container i18n="@@Commentary.Manuscript.Material">Skrivmaterial</ng-container>: {{ letterData.material }}</li>
          }
          @if (letterData.material_notes) {
            <li><ng-container i18n="@@Commentary.Manuscript.Other">Övrigt</ng-container>: {{ letterData.material_notes }}</li>
          }
        </ul>
      </div>
    }
  </div>
}
