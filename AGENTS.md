# Repository Guidelines

This repository contains the base frontend for SLS digital editions: an Angular 20.3 web app with server-side rendering (SSR).  
It is intended to be forked per edition/project, with most behavior controlled through configuration (primarily [`src/assets/config/config.ts`](src/assets/config/config.ts)).  
When contributing, changes must be reusable and config-driven; project-specific hardcoding is not allowed in this base repository.

## Project Structure & Module Organization
- `src/app/` contains application code:
  - `components/` reusable UI components (standalone by default).
  - `pages/` route entry pages (NgModule-based, due to Ionic SSR constraints).
  - `services/`, `guards/`, `interceptors/`, `tokens/`, `models/`.
- `src/assets/config/config.ts` is the main feature/config switchboard (auth, SSR, prebuild flags, menus, etc.).
- Route artifacts are generated at build time:
  - canonical: `src/app/app.routes.ts`
  - generated: `src/app/app.routes.generated.ts`
  - auth-protected paths: `src/app/auth-protected-route-paths.generated.ts`
- Build/helper scripts live in repo root (`prebuild-*.js`, `postbuild-copy-files.js`).
- Operational and architecture notes are in `docs/` (especially `DEVELOPMENT.md`, `DEPLOYMENT.md`).

## Build, Test, and Development Commands
- `npm start` - local Angular dev server.
- `npm run build:ssr` - generate routes + browser/server production build.
- `npm run serve:ssr` - run built SSR app from `dist/`.
- `npm run ssr-start` - build SSR and serve in one command.
- `npm run generate-routes` - regenerate route artifacts from config.
- `npm run test:routes-parser` - smoke tests for route parser/generator logic.
- `npm run test:ssr:smoke` - verify key SSR responses.
- `npm run bench:ssr:build` - build and benchmark SSR performance.

## Coding Style & Naming Conventions
- Use TypeScript + Angular templates/SCSS; follow existing style (2-space indentation, concise comments).
- Keep files and selectors in kebab-case; classes/interfaces in PascalCase.
- Use established suffixes (`*.service.ts`, `*.guard.ts`, `*.interceptor.ts`).
- Prefer existing path aliases (for example `@services`, `@components`, `@config`).
- Keep behavior config-driven; hardcoding fork-specific values is not allowed.

## Testing Guidelines
- Primary automated checks are script-based smoke tests (`scripts/test-*.js`).
- Add/adjust tests when changing route generation, SSR behavior, or auth routing.
- Run relevant checks before PRs (typically `test:routes-parser` and `build:ssr`; add `test:ssr:smoke` for SSR changes).

## Commit & Pull Request Guidelines
- Follow conventional commits seen in history (for example `feat(ssr): ...`, `fix(auth): ...`, `docs: ...`).
- Keep commits focused to one logical change.
- PRs should include:
  - summary of behavior change and rationale,
  - config/deployment impact (especially `src/assets/config/config.ts` and SSR/auth flags),
  - verification steps and commands run,
  - screenshots for UI changes when relevant.
- Update `CHANGELOG.md` and docs for user-visible or operational changes.

## Security & Configuration Tips
- Do not commit secrets in config or environment files.
- Auth is optional and disabled by default; forks enabling auth must validate SSR/auth behavior explicitly.
- Generated files should be regenerated by scripts, not manually edited.
